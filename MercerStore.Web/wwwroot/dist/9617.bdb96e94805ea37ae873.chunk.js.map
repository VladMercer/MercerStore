{"version":3,"file":"9617.bdb96e94805ea37ae873.chunk.js","mappings":"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","sources":["webpack://mercerstore/./wwwroot/features/cart/components/CartOffcanvasComponent.jsx","webpack://mercerstore/./wwwroot/features/cart/hooks/useFetchCartData.jsx","webpack://mercerstore/./wwwroot/features/cart/hooks/useCart.jsx"],"sourcesContent":["import React, {useEffect} from 'react';\r\nimport {useCart} from '../hooks/useCart';\r\nimport useFetchCartData from '../hooks/useFetchCartData';\r\n\r\n\r\nconst CartOffcanvasComponent = () => {\r\n    const cartItems = useFetchCartData();\r\n    const {totalPrice, removeFromCart} = useCart();\r\n    useEffect(() => {\r\n        const offcanvasCartEl = document.getElementById('offcanvasCart');\r\n        if (offcanvasCartEl) {\r\n            const offcanvasCart = new bootstrap.Offcanvas(offcanvasCartEl);\r\n\r\n            document.getElementById('cart-open')?.addEventListener('click', (e) => {\r\n                e.preventDefault();\r\n                offcanvasCart.toggle();\r\n            });\r\n        }\r\n    }, []);\r\n    return (\r\n        <div className=\"offcanvas offcanvas-end\" tabIndex=\"-1\" id=\"offcanvasCart\" aria-labelledby=\"offcanvasCartLabel\">\r\n            <div className=\"offcanvas-header\">\r\n                <h5 className=\"offcanvas-title\" id=\"offcanvasCartLabel\">Корзина</h5>\r\n                <button type=\"button\" className=\"btn-close\" data-bs-dismiss=\"offcanvas\" aria-label=\"Close\"></button>\r\n            </div>\r\n            <div className=\"offcanvas-body\">\r\n                {cartItems.length > 0 ? (\r\n                    <>\r\n                        <div className=\"table-responsive\">\r\n                            <table className=\"table offcanvasCart-table\">\r\n                                <tbody>\r\n                                {cartItems.map((item) => (\r\n                                    <tr key={item.productId}>\r\n                                        <td className=\"product-img-td\">\r\n                                            <a href={`/product/details/${item.productId}`}>\r\n                                                <img src={item.imageUrl} alt={item.name}\r\n                                                     className=\"img-fluid product-image\"/>\r\n                                            </a>\r\n                                        </td>\r\n                                        <td className=\"product-cart-name-td\">\r\n                                            <a href={`/product/details/${item.productId}`}\r\n                                               className=\"product-name-link\">\r\n                                                {item.name}\r\n                                            </a>\r\n                                        </td>\r\n\r\n                                        <td className=\"product-price-td\">{item.discountedPrice ? (\r\n                                            <div className=\"price-container\">\r\n                                                <small className=\"old-price-card\">\r\n                                                    {item.price.toLocaleString()}₽\r\n                                                </small>\r\n                                                <div className=\"\">\r\n                                                    {item.discountedPrice.toLocaleString()}₽\r\n                                                </div>\r\n                                            </div>\r\n                                        ) : (\r\n                                            <div className=\"\">\r\n                                                {item.price.toLocaleString()}₽\r\n                                            </div>\r\n                                        )}</td>\r\n                                        <td className=\"product-quantity-td\">&times;{item.quantity}</td>\r\n                                        <td className=\"remove-btn-td\">\r\n                                            <button onClick={() => removeFromCart(item.productId)}\r\n                                                    className=\"remove-from-cart-button\">\r\n                                                <i className=\"fa-solid fa-trash-can\"></i>\r\n                                            </button>\r\n                                        </td>\r\n                                    </tr>\r\n                                ))}\r\n                                </tbody>\r\n                                <tfoot>\r\n                                <tr>\r\n                                    <td colSpan=\"3\" className=\"text-end-td\">Итого:</td>\r\n                                    <td colSpan=\"2\" className=\"total-price-td\">{totalPrice} ₽</td>\r\n                                </tr>\r\n                                </tfoot>\r\n                            </table>\r\n                        </div>\r\n                        <div className=\"text-end mt-3 d-flex justify-content-between fixed-bottom-buttons\">\r\n                            <a href=\"/cart\" className=\"btn btn-outline-warning\" id=\"button-offcanvas-cart\">Перейти в\r\n                                корзину</a>\r\n                            <a href=\"/order\" className=\"btn btn-outline-warning\" id=\"button-offcanvas-checkout\">Оформить\r\n                                заказ</a>\r\n                        </div>\r\n                    </>\r\n                ) : (\r\n                    <p>Ваша корзина пуста</p>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default CartOffcanvasComponent;","import {useDispatch, useSelector} from 'react-redux';\r\nimport {useEffect} from 'react';\r\nimport {fetchCartData, generateToken, sendHeartbeat} from '../redux/cartSlice';\r\n\r\nconst useFetchCartData = () => {\r\n    const dispatch = useDispatch();\r\n    const {items, isLoaded} = useSelector((state) => state.cart);\r\n\r\n    useEffect(() => {\r\n        if (!isLoaded) {\r\n            dispatch(generateToken())\r\n            dispatch(fetchCartData());\r\n\r\n        }\r\n    }, [isLoaded, dispatch]);\r\n\r\n    useEffect(() => {\r\n        const interval = setInterval(() => {\r\n            dispatch(sendHeartbeat());\r\n        }, 60000);\r\n\r\n        return () => clearInterval(interval);\r\n    }, [dispatch]);\r\n\r\n    return items;\r\n};\r\nexport default useFetchCartData;","import {useDispatch, useSelector} from 'react-redux';\r\nimport {addToCart, removeFromCart} from '../redux/cartSlice';\r\n\r\nexport const useCart = () => {\r\n    const dispatch = useDispatch();\r\n    const {items, totalPrice, itemCount} = useSelector((state) => state.cart);\r\n\r\n    return {\r\n        items,\r\n        totalPrice,\r\n        itemCount,\r\n        addToCart: (productId) => dispatch(addToCart(productId)),\r\n        removeFromCart: (productId) => dispatch(removeFromCart(productId)),\r\n    };\r\n};"],"names":["dispatch","_useSelector","items","isLoaded","cartItems","useDispatch","useSelector","state","cart","useEffect","generateToken","fetchCartData","interval","setInterval","sendHeartbeat","clearInterval","_useCart","useCart","totalPrice","removeFromCart","offcanvasCartEl","document","getElementById","_document$getElementB","offcanvasCart","bootstrap","Offcanvas","addEventListener","e","preventDefault","toggle","_jsxs","className","tabIndex","id","children","_jsx","type","length","_Fragment","map","item","href","concat","productId","src","imageUrl","alt","name","discountedPrice","price","toLocaleString","quantity","onClick","colSpan","itemCount","addToCart"],"sourceRoot":""}